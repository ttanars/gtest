<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>แบบฟอร์มข้อมูลนักเรียน (ปรับปรุง)</title>
    <script src="sweetalert2.min.js"></script>
    <link rel="stylesheet" href="sweetalert2.min.css">
    <style>
        :root {
            /* Adjusted Pastel Colors for more clarity */
            --primary-color: #8ecae6;  /* Slightly stronger Pastel Blue */
            --secondary-color: #219ebc; /* Stronger Blue for accents/headings */
            --background-color: #fefae0; /* Creamy Pastel Yellow */
            --text-color: #333;
            --input-bg: #ffffff;
            --border-color: #d4d4d4; /* Slightly darker border */
            --button-bg: #fb8500;    /* Vibrant Orange for action buttons */
            --button-hover-bg: #e27602; /* Darker Orange on hover */
            --prev-button-bg: #adb5bd;  /* Clear Grey for previous button */
            --prev-button-hover-bg: #9fa6ae;
            --step-inactive-bg: #ced4da;
            --step-active-bg: var(--primary-color);
            --step-completed-bg: var(--secondary-color);
            --step-line-color: #e0e0e0;
            --danger-color: #e63946;   /* Clear Pastel Red */
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Sarabun', sans-serif;
            background-color: var(--background-color);
            color: var(--text-color);
            line-height: 1.6;
            display: flex;
            justify-content: center;
            align-items: flex-start; /* Align top for longer forms */
            min-height: 100vh;
            padding: 30px 20px; /* More padding top/bottom */
        }

        .form-container {
            background-color: var(--input-bg);
            padding: 30px 40px;
            border-radius: 15px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1); /* Slightly stronger shadow */
            width: 100%;
            max-width: 750px; /* Slightly wider */
            overflow: hidden;
            border: 1px solid var(--border-color);
            margin-bottom: 30px; /* Space at the bottom */
        }

        .banner img {
            width: 100%;
            max-height: 180px; /* Adjust banner height if needed */
            object-fit: cover;
            border-radius: 10px; /* Rounded corners for banner */
            margin-bottom: 25px;
            display: block;
            background-color: #eee; /* Placeholder bg color */
            border: 1px solid var(--border-color); /* Add border if image fails */
        }

        h1 {
            text-align: center;
            color: var(--secondary-color);
            margin-bottom: 15px; /* Reduced margin below h1 */
            font-size: 1.9em;
        }

        /* --- Step Indicator Styles --- */
        .step-indicator-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 35px; /* Space below indicator */
            position: relative; /* For line positioning */
            padding: 0 10px; /* Padding to avoid touching edges */
        }

        .step-indicator-container::before { /* The connecting line */
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 3px; /* Line thickness */
            background-color: var(--step-line-color);
            transform: translateY(-50%);
            z-index: 1; /* Behind circles */
            width: calc(100% - 40px); /* Adjust width based on padding/circle size */
            margin: 0 auto; /* Center the line */
        }


        .step-circle {
            width: 35px; /* Circle size */
            height: 35px;
            border-radius: 50%;
            background-color: var(--step-inactive-bg);
            color: white;
            display: flex;
            justify-content: center;
            align-items: center;
            font-weight: 600;
            font-size: 1rem;
            z-index: 2; /* Above line */
            position: relative; /* Needed for z-index */
            border: 3px solid var(--input-bg); /* Create space between line and circle */
            transition: background-color 0.3s ease;
        }

        .step-circle.completed {
            background-color: var(--step-completed-bg);
        }

        .step-circle.active {
            background-color: var(--step-active-bg);
            transform: scale(1.1); /* Slightly bigger active step */
            box-shadow: 0 0 8px rgba(142, 202, 230, 0.7);
        }

        /* --- End Step Indicator Styles --- */

        .form-step {
            display: none;
            animation: fadeIn 0.5s ease-in-out;
        }

        .form-step.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(15px); }
            to { opacity: 1; transform: translateY(0); }
        }


        .form-group {
            margin-bottom: 22px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #444; /* Slightly darker label */
        }

        input[type="text"],
        input[type="number"],
        select,
        textarea {
            width: 100%;
            padding: 12px 15px; /* More horizontal padding */
            border: 1px solid var(--border-color);
            border-radius: 8px;
            background-color: #fcfcfc; /* Slightly off-white input bg */
            font-size: 1rem;
            font-family: inherit; /* Ensure font consistency */
            transition: border-color 0.3s ease, box-shadow 0.3s ease;
        }

         input[type="text"]:focus,
         input[type="number"]:focus,
         select:focus,
         textarea:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(142, 202, 230, 0.3); /* Focus ring matching primary */
         }

        input.invalid,
        select.invalid,
        textarea.invalid {
            border-color: var(--danger-color);
            background-color: #fffafa; /* Lighter red background for invalid */
        }
        .error-message {
            color: #d9534f;
            font-size: 0.88em;
            margin-top: 6px;
            display: none;
        }


        select {
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%236c757d'%3E%3Cpath d='M7 10l5 5 5-5H7z'/%3E%3C/svg%3E"); /* Darker arrow */
            background-repeat: no-repeat;
            background-position: right 15px center;
            background-size: 1.3em;
            padding-right: 40px;
        }

        textarea {
            resize: vertical;
            min-height: 110px;
        }

        .button-group {
            display: flex;
            justify-content: space-between;
            margin-top: 35px;
        }

        button {
            padding: 12px 28px; /* Slightly more padding */
            border: none;
            border-radius: 8px;
            color: white;
            font-size: 1.05rem; /* Slightly larger font */
            font-weight: 600;
            font-family: inherit;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.1s ease;
            min-width: 110px;
        }

        button:hover {
            transform: translateY(-2px); /* Slight lift on hover */
        }
         button:active {
            transform: scale(0.98) translateY(-1px);
         }

        .next-btn, button[type="submit"] {
            background-color: var(--button-bg); /* Use main action color */
        }
        .next-btn:hover, button[type="submit"]:hover {
            background-color: var(--button-hover-bg);
        }

        .prev-btn {
            background-color: var(--prev-button-bg); /* Distinct previous button color */
        }
        .prev-btn:hover {
            background-color: var(--prev-button-hover-bg);
        }

        button:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
            transform: none; /* No hover/active effects */
        }


        .checkbox-group label {
            display: flex;
            align-items: center;
            margin-bottom: 12px;
            font-weight: normal;
            cursor: pointer;
        }

        .checkbox-group input[type="checkbox"] {
             width: auto;
             margin-right: 12px;
             accent-color: var(--secondary-color); /* Use accent color for checkbox */
             transform: scale(1.15);
             cursor: pointer;
        }

        /* Hide basic messages, SweetAlert will be used */
        #loadingMessage, #successMessage, #errorMessage {
            display: none;
        }

        h2 { /* Step Title Styling */
            color: var(--secondary-color);
            margin-bottom: 25px;
            border-bottom: 2px solid var(--step-line-color);
            padding-bottom: 10px;
            font-size: 1.4em;
        }


        /* Responsive Design */
        @media (max-width: 768px) {
            .form-container {
                padding: 25px;
            }
            h1 {
                font-size: 1.6em;
            }
             button {
                 padding: 11px 22px;
                 font-size: 1rem;
             }
             .step-indicator-container {
                 margin-bottom: 30px;
                 padding: 0 5px;
             }
             .step-circle {
                 width: 30px;
                 height: 30px;
                 font-size: 0.9rem;
             }
              .step-indicator-container::before {
                 width: calc(100% - 30px);
             }
        }
         @media (max-width: 480px) {
             .button-group {
                 flex-direction: column-reverse;
                 gap: 12px;
             }
             button {
                 width: 100%;
             }
             .step-indicator-container {
                 /* Could potentially stack vertically or simplify further on very small screens */
             }
         }
    </style>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@400;600;700&display=swap" rel="stylesheet">
</head>
<body>

    <div class="form-container">
        <div class="banner">
            <img src="https://lh5.googleusercontent.com/d/1OMvK1PGb4x0SwNl2EB1q42ow0RPzmVE0" alt="Form Banner">
        </div>
        <h1>แบบฟอร์มข้อมูลนักเรียน</h1>

        <div class="step-indicator-container">
            <div class="step-circle" data-step-id="1">1</div>
             <div class="step-circle" data-step-id="2">2</div>
             <div class="step-circle" data-step-id="3">3</div>
             <div class="step-circle" data-step-id="4">4</div>
             <div class="step-circle" data-step-id="5">5</div>
             <div class="step-circle" data-step-id="6">6</div>
             <div class="step-circle" data-step-id="7">7</div>
             <div class="step-circle" data-step-id="8">8</div>
        </div>

        <form id="multiStepForm">
            <div class="form-step active" data-step="1">
                <h2>ตอนที่ 1: ข้อมูลทั่วไป</h2>
                <div class="form-group">
                    <label for="studentId">1. เลขประจำตัวนักเรียน 5 ตัว</label>
                    <input type="text" id="studentId" name="entry.901399508" required pattern="[0-9]{5}" maxlength="5" minlength="5" inputmode="numeric" title="กรุณากรอกเลขประจำตัว 5 หลัก">
                    <span class="error-message">กรุณากรอกเลขประจำตัว 5 หลัก</span>
                </div>
                <div class="form-group">
                    <label for="fullName">2. ชื่อ - สกุล</label>
                    <input type="text" id="fullName" name="entry.1449350406" required pattern="^(นาย|นางสาว|เด็กชาย|เด็กหญิง).*" title="กรุณาขึ้นต้นด้วยคำนำหน้าชื่อ (นาย, นางสาว, เด็กชาย, เด็กหญิง) ตามด้วยชื่อและนามสกุล">
                     <span class="error-message">กรุณาขึ้นต้นด้วยคำนำหน้าชื่อตามที่กำหนด</span>
                </div>
                <div class="form-group">
                    <label for="nickname">3. ชื่อเล่น</label>
                    <input type="text" id="nickname" name="entry.1869399203" required>
                     <span class="error-message">กรุณากรอกชื่อเล่น</span>
                </div>
                 <div class="form-group">
                    <label for="classLevel">4. ชั้น</label>
                    <input type="text" id="classLevel" name="entry.1214857566" required pattern="^ม\.[1-6]\/(1[0-4]|[1-9])$" placeholder="เช่น ม.4/1" title="รูปแบบ: ม.[1-6]/[1-14]">
                    <span class="error-message">กรุณากรอกชั้นในรูปแบบ ม.1/1 ถึง ม.6/14</span>
                </div>
                <div class="form-group">
                    <label for="classNumber">5. เลขที่</label>
                    <input type="number" id="classNumber" name="entry.1800970519" required min="1">
                    <span class="error-message">กรุณากรอกเลขที่</span>
                </div>
                 <div class="form-group">
                    <label for="gpa">6. เกรดเฉลี่ยวิชาเคมีหรือวิทยาศาสตร์ล่าสุด</label>
                    <input type="number" id="gpa" name="entry.2136882557" required min="0" max="4.00" step="0.01">
                     <span class="error-message">กรุณากรอกเกรดเฉลี่ยระหว่าง 0.00 - 4.00</span>
                </div>
                 <div class="form-group">
                    <label for="careerInterest">7. อาชีพที่สนใจ</label>
                    <input type="text" id="careerInterest" name="entry.1172167688" required>
                     <span class="error-message">กรุณากรอกอาชีพที่สนใจ</span>
                </div>
                <div class="form-group">
                    <label for="weight">8. น้ำหนัก (กก.)</label>
                    <input type="number" id="weight" name="entry.1160190571" required min="0">
                     <span class="error-message">กรุณากรอกน้ำหนัก</span>
                </div>
                <div class="form-group">
                    <label for="height">9. ส่วนสูง (ซม.)</label>
                    <input type="number" id="height" name="entry.1192896977" required min="0">
                     <span class="error-message">กรุณากรอกส่วนสูง</span>
                </div>
                 <div class="form-group">
                    <label for="healthCondition">10. โรคประจำตัว (ถ้าไม่มีใส่ -)</label>
                    <input type="text" id="healthCondition" name="entry.284456816" required>
                     <span class="error-message">กรุณากรอกโรคประจำตัว หรือใส่ "-" ถ้าไม่มี</span>
                </div>
                 <div class="form-group">
                    <label for="specialTalent">11. ความสามารถพิเศษ (ถ้าไม่มีใส่ -)</label>
                    <input type="text" id="specialTalent" name="entry.684640240" required>
                     <span class="error-message">กรุณากรอกความสามารถพิเศษ หรือใส่ "-" ถ้าไม่มี</span>
                </div>
                 <div class="form-group">
                    <label for="scholarship">12. ต้องการขอทุนการศึกษาหรือไม่</label>
                    <select id="scholarship" name="entry.1825464514" required>
                        <option value="" disabled selected>-- กรุณาเลือก --</option>
                        <option value="ต้องการ">ต้องการ</option>
                        <option value="ไม่ต้องการ">ไม่ต้องการ</option>
                    </select>
                     <span class="error-message">กรุณาเลือกตัวเลือก</span>
                </div>
                <div class="button-group">
                    <span></span> <button type="button" class="next-btn" onclick="nextStep()">ถัดไป</button>
                </div>
            </div>

            <div class="form-step" data-step="2">
                <h2>ตอนที่ 2: ความรู้พื้นฐานของวิชา</h2>
                 <div class="form-group">
                    <label for="thaiKnowledge">13. ความรู้พื้นฐานของวิชาภาษาไทย</label>
                    <select id="thaiKnowledge" name="entry.420059005" required>
                        <option value="" disabled selected>-- กรุณาเลือก --</option>
                        <option value="ดีมาก (เกรด 3.5 - 4.00)">ดีมาก (เกรด 3.5 - 4.00)</option>
                        <option value="ดี (เกรด 2.5 - 3.00)">ดี (เกรด 2.5 - 3.00)</option>
                        <option value="พอใช้ (เกรด 0 - 2.00)">พอใช้ (เกรด 0 - 2.00)</option>
                    </select>
                     <span class="error-message">กรุณาเลือกตัวเลือก</span>
                </div>
                <div class="form-group">
                    <label for="scienceKnowledge">14. ความรู้พื้นฐานของวิชาวิทยาศาสตร์</label>
                    <select id="scienceKnowledge" name="entry.593158496" required>
                        <option value="" disabled selected>-- กรุณาเลือก --</option>
                        <option value="ดีมาก (เกรด 3.5 - 4.00)">ดีมาก (เกรด 3.5 - 4.00)</option>
                        <option value="ดี (เกรด 2.5 - 3.00)">ดี (เกรด 2.5 - 3.00)</option>
                        <option value="พอใช้ (เกรด 0 - 2.00)">พอใช้ (เกรด 0 - 2.00)</option>
                    </select>
                    <span class="error-message">กรุณาเลือกตัวเลือก</span>
                </div>
                 <div class="form-group">
                    <label for="foreignLangKnowledge">15. ความรู้พื้นฐานของวิชาภาษาต่างประเทศ</label>
                    <select id="foreignLangKnowledge" name="entry.865418515" required>
                        <option value="" disabled selected>-- กรุณาเลือก --</option>
                        <option value="ดีมาก (เกรด 3.5 - 4.00)">ดีมาก (เกรด 3.5 - 4.00)</option>
                        <option value="ดี (เกรด 2.5 - 3.00)">ดี (เกรด 2.5 - 3.00)</option>
                        <option value="พอใช้ (เกรด 0 - 2.00)">พอใช้ (เกรด 0 - 2.00)</option>
                    </select>
                     <span class="error-message">กรุณาเลือกตัวเลือก</span>
                </div>
                <div class="form-group">
                    <label for="socialStudiesKnowledge">16. ความรู้พื้นฐานของวิชาสังคมศึกษา ศาสนาและวัฒนธรรม</label>
                    <select id="socialStudiesKnowledge" name="entry.357467146" required>
                        <option value="" disabled selected>-- กรุณาเลือก --</option>
                        <option value="ดีมาก (เกรด 3.5 - 4.00)">ดีมาก (เกรด 3.5 - 4.00)</option>
                        <option value="ดี (เกรด 2.5 - 3.00)">ดี (เกรด 2.5 - 3.00)</option>
                        <option value="พอใช้ (เกรด 0 - 2.00)">พอใช้ (เกรด 0 - 2.00)</option>
                    </select>
                    <span class="error-message">กรุณาเลือกตัวเลือก</span>
                </div>
                <div class="form-group">
                    <label for="artKnowledge">17. ความรู้พื้นฐานของวิชาศิลปะ</label>
                    <select id="artKnowledge" name="entry.1093705935" required>
                         <option value="" disabled selected>-- กรุณาเลือก --</option>
                        <option value="ดีมาก (เกรด 3.5 - 4.00)">ดีมาก (เกรด 3.5 - 4.00)</option>
                        <option value="ดี (เกรด 2.5 - 3.00)">ดี (เกรด 2.5 - 3.00)</option>
                        <option value="พอใช้ (เกรด 0 - 2.00)">พอใช้ (เกรด 0 - 2.00)</option>
                    </select>
                     <span class="error-message">กรุณาเลือกตัวเลือก</span>
                </div>
                <div class="form-group">
                    <label for="healthPeKnowledge">18. ความรู้พื้นฐานของวิชาสุขศึกษาและพลศึกษา</label>
                    <select id="healthPeKnowledge" name="entry.148847289" required>
                        <option value="" disabled selected>-- กรุณาเลือก --</option>
                        <option value="ดีมาก (เกรด 3.5 - 4.00)">ดีมาก (เกรด 3.5 - 4.00)</option>
                        <option value="ดี (เกรด 2.5 - 3.00)">ดี (เกรด 2.5 - 3.00)</option>
                        <option value="พอใช้ (เกรด 0 - 2.00)">พอใช้ (เกรด 0 - 2.00)</option>
                    </select>
                    <span class="error-message">กรุณาเลือกตัวเลือก</span>
                </div>
                 <div class="form-group">
                    <label for="careerTechKnowledge">19. ความรู้พื้นฐานของวิชาการงานอาชีพ</label>
                    <select id="careerTechKnowledge" name="entry.987375589" required>
                        <option value="" disabled selected>-- กรุณาเลือก --</option>
                        <option value="ดีมาก (เกรด 3.5 - 4.00)">ดีมาก (เกรด 3.5 - 4.00)</option>
                        <option value="ดี (เกรด 2.5 - 3.00)">ดี (เกรด 2.5 - 3.00)</option>
                        <option value="พอใช้ (เกรด 0 - 2.00)">พอใช้ (เกรด 0 - 2.00)</option>
                    </select>
                     <span class="error-message">กรุณาเลือกตัวเลือก</span>
                </div>
                <div class="button-group">
                    <button type="button" class="prev-btn" onclick="prevStep()">ย้อนกลับ</button>
                    <button type="button" class="next-btn" onclick="nextStep()">ถัดไป</button>
                </div>
            </div>

            <div class="form-step" data-step="3">
                <h2>ตอนที่ 3: ความรู้ ความสามารถและประสบการณ์</h2>
                <div class="form-group">
                    <label for="problemSolving">20. ความสามารถในการแก้ปัญหา</label>
                    <select id="problemSolving" name="entry.498547039" required>
                        <option value="" disabled selected>-- กรุณาเลือก --</option>
                        <option value="ดีมาก">ดีมาก</option>
                        <option value="ปานกลาง">ปานกลาง</option>
                        <option value="ปรับปรุงแก้ไข">ปรับปรุงแก้ไข</option>
                    </select>
                     <span class="error-message">กรุณาเลือกตัวเลือก</span>
                </div>
                 <div class="form-group">
                    <label for="learningFocus">21. ความสนใจและสมาธิในการเรียนรู้</label>
                    <select id="learningFocus" name="entry.1472391848" required>
                        <option value="" disabled selected>-- กรุณาเลือก --</option>
                        <option value="ดีมาก">ดีมาก</option>
                        <option value="ปานกลาง">ปานกลาง</option>
                        <option value="ปรับปรุงแก้ไข">ปรับปรุงแก้ไข</option>
                    </select>
                    <span class="error-message">กรุณาเลือกตัวเลือก</span>
                </div>
                <div class="button-group">
                    <button type="button" class="prev-btn" onclick="prevStep()">ย้อนกลับ</button>
                    <button type="button" class="next-btn" onclick="nextStep()">ถัดไป</button>
                </div>
            </div>

            <div class="form-step" data-step="4">
                <h2>ตอนที่ 4: ความพร้อมด้านสติปัญญา</h2>
                <div class="form-group">
                    <label for="creativity">22. ความคิดริเริ่มสร้างสรรค์</label>
                    <select id="creativity" name="entry.1403007028" required>
                         <option value="" disabled selected>-- กรุณาเลือก --</option>
                        <option value="ดีมาก">ดีมาก</option>
                        <option value="ปานกลาง">ปานกลาง</option>
                        <option value="ปรับปรุงแก้ไข">ปรับปรุงแก้ไข</option>
                    </select>
                    <span class="error-message">กรุณาเลือกตัวเลือก</span>
                </div>
                <div class="form-group">
                    <label for="reasoning">23. ความมีเหตุผล</label>
                    <select id="reasoning" name="entry.452501773" required>
                         <option value="" disabled selected>-- กรุณาเลือก --</option>
                        <option value="ดีมาก">ดีมาก</option>
                        <option value="ปานกลาง">ปานกลาง</option>
                        <option value="ปรับปรุงแก้ไข">ปรับปรุงแก้ไข</option>
                    </select>
                     <span class="error-message">กรุณาเลือกตัวเลือก</span>
                </div>
                <div class="form-group">
                    <label for="learningAbility">24. ความสามารถในการเรียนรู้</label>
                    <select id="learningAbility" name="entry.479167122" required>
                         <option value="" disabled selected>-- กรุณาเลือก --</option>
                        <option value="ดีมาก">ดีมาก</option>
                        <option value="ปานกลาง">ปานกลาง</option>
                        <option value="ปรับปรุงแก้ไข">ปรับปรุงแก้ไข</option>
                    </select>
                    <span class="error-message">กรุณาเลือกตัวเลือก</span>
                </div>
                <div class="button-group">
                    <button type="button" class="prev-btn" onclick="prevStep()">ย้อนกลับ</button>
                    <button type="button" class="next-btn" onclick="nextStep()">ถัดไป</button>
                </div>
            </div>

            <div class="form-step" data-step="5">
                <h2>ตอนที่ 5: ความพร้อมด้านพฤติกรรม</h2>
                 <div class="form-group">
                    <label for="expression">25. การแสดงออก</label>
                    <select id="expression" name="entry.739511892" required>
                         <option value="" disabled selected>-- กรุณาเลือก --</option>
                        <option value="ดีมาก">ดีมาก</option>
                        <option value="ปานกลาง">ปานกลาง</option>
                        <option value="ปรับปรุงแก้ไข">ปรับปรุงแก้ไข</option>
                    </select>
                     <span class="error-message">กรุณาเลือกตัวเลือก</span>
                </div>
                 <div class="form-group">
                    <label for="emotionControl">26. การควบคุมอารมณ์</label>
                    <select id="emotionControl" name="entry.1937908905" required>
                        <option value="" disabled selected>-- กรุณาเลือก --</option>
                        <option value="ดีมาก">ดีมาก</option>
                        <option value="ปานกลาง">ปานกลาง</option>
                        <option value="ปรับปรุงแก้ไข">ปรับปรุงแก้ไข</option>
                    </select>
                     <span class="error-message">กรุณาเลือกตัวเลือก</span>
                </div>
                 <div class="form-group">
                    <label for="determination">27. ความมุ่งมั่น อดทน ขยันหมั่นเพียร</label>
                    <select id="determination" name="entry.1978274585" required>
                         <option value="" disabled selected>-- กรุณาเลือก --</option>
                        <option value="ดีมาก">ดีมาก</option>
                        <option value="ปานกลาง">ปานกลาง</option>
                        <option value="ปรับปรุงแก้ไข">ปรับปรุงแก้ไข</option>
                    </select>
                    <span class="error-message">กรุณาเลือกตัวเลือก</span>
                </div>
                <div class="form-group">
                    <label for="responsibility">28. ความรับผิดชอบ</label>
                    <select id="responsibility" name="entry.1692721860" required>
                        <option value="" disabled selected>-- กรุณาเลือก --</option>
                        <option value="ดีมาก">ดีมาก</option>
                        <option value="ปานกลาง">ปานกลาง</option>
                        <option value="ปรับปรุงแก้ไข">ปรับปรุงแก้ไข</option>
                    </select>
                     <span class="error-message">กรุณาเลือกตัวเลือก</span>
                </div>
                <div class="button-group">
                    <button type="button" class="prev-btn" onclick="prevStep()">ย้อนกลับ</button>
                    <button type="button" class="next-btn" onclick="nextStep()">ถัดไป</button>
                </div>
            </div>

             <div class="form-step" data-step="6">
                <h2>ตอนที่ 6: ความพร้อมด้านร่างกาย</h2>
                <div class="form-group">
                    <label for="physicalHealth">29. ด้านสุขภาพร่างกายสมบูรณ์</label>
                    <select id="physicalHealth" name="entry.1796425220" required>
                        <option value="" disabled selected>-- กรุณาเลือก --</option>
                        <option value="ดีมาก">ดีมาก</option>
                        <option value="ปานกลาง">ปานกลาง</option>
                        <option value="ปรับปรุงแก้ไข">ปรับปรุงแก้ไข</option>
                    </select>
                     <span class="error-message">กรุณาเลือกตัวเลือก</span>
                </div>
                <div class="form-group">
                    <label for="growth">30. การเจริญเติบโตสมวัย</label>
                    <select id="growth" name="entry.777433819" required>
                         <option value="" disabled selected>-- กรุณาเลือก --</option>
                        <option value="ดีมาก">ดีมาก</option>
                        <option value="ปานกลาง">ปานกลาง</option>
                        <option value="ปรับปรุงแก้ไข">ปรับปรุงแก้ไข</option>
                    </select>
                    <span class="error-message">กรุณาเลือกตัวเลือก</span>
                </div>
                 <div class="form-group">
                    <label for="mentalHealth">31. ด้านสุขภาพจิต</label>
                    <select id="mentalHealth" name="entry.839726625" required>
                        <option value="" disabled selected>-- กรุณาเลือก --</option>
                        <option value="ดีมาก">ดีมาก</option>
                        <option value="ปานกลาง">ปานกลาง</option>
                        <option value="ปรับปรุงแก้ไข">ปรับปรุงแก้ไข</option>
                    </select>
                     <span class="error-message">กรุณาเลือกตัวเลือก</span>
                </div>
                <div class="button-group">
                    <button type="button" class="prev-btn" onclick="prevStep()">ย้อนกลับ</button>
                    <button type="button" class="next-btn" onclick="nextStep()">ถัดไป</button>
                </div>
            </div>

            <div class="form-step" data-step="7">
                 <h2>ตอนที่ 7: ความพร้อมด้านสังคม</h2>
                <div class="form-group">
                    <label for="adaptation">32. การปรับตัวเข้ากับผู้อื่น</label>
                    <select id="adaptation" name="entry.1735047925" required>
                         <option value="" disabled selected>-- กรุณาเลือก --</option>
                        <option value="ดีมาก">ดีมาก</option>
                        <option value="ปานกลาง">ปานกลาง</option>
                        <option value="ปรับปรุงแก้ไข">ปรับปรุงแก้ไข</option>
                    </select>
                    <span class="error-message">กรุณาเลือกตัวเลือก</span>
                </div>
                <div class="form-group">
                    <label for="sacrifice">33. การเสียสละไม่เห็นแก่ตัว</label>
                    <select id="sacrifice" name="entry.1156396607" required>
                        <option value="" disabled selected>-- กรุณาเลือก --</option>
                        <option value="ดีมาก">ดีมาก</option>
                        <option value="ปานกลาง">ปานกลาง</option>
                        <option value="ปรับปรุงแก้ไข">ปรับปรุงแก้ไข</option>
                    </select>
                    <span class="error-message">กรุณาเลือกตัวเลือก</span>
                </div>
                 <div class="form-group">
                    <label for="discipline">34. มีระเบียบวินัยเคารพกฏกติกา</label>
                    <select id="discipline" name="entry.1204348460" required>
                        <option value="" disabled selected>-- กรุณาเลือก --</option>
                        <option value="ดีมาก">ดีมาก</option>
                        <option value="ปานกลาง">ปานกลาง</option>
                        <option value="ปรับปรุงแก้ไข">ปรับปรุงแก้ไข</option>
                    </select>
                    <span class="error-message">กรุณาเลือกตัวเลือก</span>
                </div>
                <div class="button-group">
                    <button type="button" class="prev-btn" onclick="prevStep()">ย้อนกลับ</button>
                    <button type="button" class="next-btn" onclick="nextStep()">ถัดไป</button>
                </div>
            </div>

             <div class="form-step" data-step="8">
                <h2>ตอนที่ 8: การจัดกิจกรรมการเรียนรู้ & ข้อเสนอแนะ</h2>
                <div class="form-group">
                    <label>35. รูปแบบกิจกรรมการเรียนรู้ที่นักเรียนต้องการ (เลือกได้มากกว่า 1 ข้อ)</label>
                    <div class="checkbox-group">
                         <label><input type="checkbox" name="entry.1930257384" value="แบบบรรยาย"> แบบบรรยาย</label>
                         <label><input type="checkbox" name="entry.1930257384" value="แบบอภิปราย"> แบบอภิปราย</label>
                         <label><input type="checkbox" name="entry.1930257384" value="แบบสร้างแผนผังความคิด"> แบบสร้างแผนผังความคิด</label>
                         <label><input type="checkbox" name="entry.1930257384" value="แบบใช้คำถาม"> แบบใช้คำถาม</label>
                         <label><input type="checkbox" name="entry.1930257384" value="แบบทดลอง"> แบบทดลอง</label>
                         <label><input type="checkbox" name="entry.1930257384" value="แบบโครงงาน"> แบบโครงงาน</label>
                         <label><input type="checkbox" name="entry.1930257384" value="แบบระดมสมอง"> แบบระดมสมอง</label>
                         <label><input type="checkbox" name="entry.1930257384" value="กระบวนการกลุ่ม"> กระบวนการกลุ่ม</label>
                         <label><input type="checkbox" name="entry.1930257384" value="แบบสาธิต"> แบบสาธิต</label>
                         <label><input type="checkbox" name="entry.1930257384" value="แบบแสดงบทบาทสมมุติ"> แบบแสดงบทบาทสมมุติ</label>
                         <label><input type="checkbox" name="entry.1930257384" value="แบบบูรณาการ"> แบบบูรณาการ</label>
                         <label><input type="checkbox" name="entry.1930257384" value="แบบให้ลงมือปฏิบัติ"> แบบให้ลงมือปฏิบัติ</label>
                         <label><input type="checkbox" name="entry.1930257384" value="แบบสืบค้นหาความรู้ด้วยตนเอง"> แบบสืบค้นหาความรู้ด้วยตนเอง</label>
                    </div>
                </div>
                 <div class="form-group">
                    <label for="suggestions">36. ข้อเสนอแนะ (ถ้าไม่มีใส่ -)</label>
                    <textarea id="suggestions" name="entry.1941801070" rows="4" required></textarea>
                     <span class="error-message">กรุณากรอกข้อเสนอแนะ หรือใส่ "-" ถ้าไม่มี</span>
                </div>
                <div class="button-group">
                    <button type="button" class="prev-btn" onclick="prevStep()">ย้อนกลับ</button>
                    <button type="submit" id="submitBtn">ส่งข้อมูล</button>
                </div>
            </div>

        </form>

        <div id="loadingMessage">กำลังส่งข้อมูล...</div>
        <div id="successMessage">ส่งข้อมูลเรียบร้อยแล้ว ขอบคุณครับ/ค่ะ</div>
        <div id="errorMessage">เกิดข้อผิดพลาดในการส่งข้อมูล โปรดลองอีกครั้ง</div>

    </div>

    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.all.min.js"></script>
    <script>
        let currentStep = 1;
        const formSteps = document.querySelectorAll('.form-step');
        const form = document.getElementById('multiStepForm');
        const submitBtn = document.getElementById('submitBtn');
        const stepCircles = document.querySelectorAll('.step-circle');

        // --- Google Form Details ---
        const googleFormUrl = 'https://docs.google.com/forms/d/e/1FAIpQLSdg0isIK8rprD7FXau1l1tFIGgyG09aC7VemoF-PDWhVdZItg/formResponse'; // Replace if yours is different

        function updateProgressIndicator(stepNumber) {
            stepCircles.forEach((circle, index) => {
                circle.classList.remove('active', 'completed');
                const circleStep = parseInt(circle.getAttribute('data-step-id')); // Use data-step-id
                if (circleStep < stepNumber) {
                    circle.classList.add('completed');
                } else if (circleStep === stepNumber) {
                    circle.classList.add('active');
                }
            });
        }


        function showStep(stepNumber) {
            formSteps.forEach(step => step.classList.remove('active'));
            const stepToShow = document.querySelector(`.form-step[data-step="${stepNumber}"]`);
            if(stepToShow) {
                stepToShow.classList.add('active');
                updateProgressIndicator(stepNumber); // Update progress bar
                 window.scrollTo({ top: 0, behavior: 'smooth' }); // Scroll to top on step change
            }
        }

        function validateStep(stepNumber) {
            const currentStepElement = document.querySelector(`.form-step[data-step="${stepNumber}"]`);
            if (!currentStepElement) return false;

            let isValid = true;
            const inputs = currentStepElement.querySelectorAll('input[required], select[required], textarea[required]');

            inputs.forEach(input => {
                let inputValid = true;
                if (input.type === 'checkbox') {
                    // Basic check for required checkboxes - not implemented here, adjust if needed
                } else if (input.tagName.toLowerCase() === 'select' && input.value === "") {
                     inputValid = false;
                } else if (!input.checkValidity()) {
                     inputValid = false;
                }

                const errorSpan = input.closest('.form-group')?.querySelector('.error-message'); // Use optional chaining
                 if (!inputValid) {
                    isValid = false;
                    input.classList.add('invalid');
                    if (errorSpan) errorSpan.style.display = 'block';
                 } else {
                    input.classList.remove('invalid');
                    if (errorSpan) errorSpan.style.display = 'none';
                 }
            });

            return isValid;
        }


        function nextStep() {
            if (validateStep(currentStep)) {
                 if (currentStep < formSteps.length) {
                    currentStep++;
                    showStep(currentStep);
                 }
            } else {
                 const firstInvalid = document.querySelector(`.form-step[data-step="${currentStep}"] .invalid`);
                 if(firstInvalid) {
                    firstInvalid.focus();
                    // Optional: Add a small shake animation or stronger visual cue
                 }
            }
        }

        function prevStep() {
            if (currentStep > 1) {
                currentStep--;
                showStep(currentStep);
                 const inputs = document.querySelectorAll(`.form-step[data-step="${currentStep}"] .invalid`);
                 inputs.forEach(input => {
                    input.classList.remove('invalid');
                    const errorSpan = input.closest('.form-group')?.querySelector('.error-message');
                    if (errorSpan) errorSpan.style.display = 'none';
                 });
            }
        }

        form.addEventListener('submit', function(event) {
            event.preventDefault();

            if (!validateStep(currentStep)) {
                 const firstInvalid = document.querySelector(`.form-step[data-step="${currentStep}"] .invalid`);
                 if(firstInvalid) {
                    firstInvalid.focus();
                 }
                 return;
            }

            // Show loading state (could use SweetAlert loading)
            submitBtn.disabled = true;
             Swal.showLoading({ // Use SweetAlert loading indicator
                title: 'กำลังส่งข้อมูล...',
                allowOutsideClick: false,
                didOpen: () => {
                    Swal.showLoading();
                }
             });


            const formData = new FormData(form);

            fetch(googleFormUrl, {
                method: 'POST',
                body: formData,
                mode: 'no-cors'
            })
            .then(response => {
                console.log('Form submission attempted.');
                 Swal.close(); // Close loading indicator
                 // Show SweetAlert success popup
                 Swal.fire({
                    title: 'สำเร็จ!',
                    text: 'บันทึกข้อมูลเรียบร้อยแล้ว',
                    icon: 'success',
                    confirmButtonText: 'ตกลง',
                    confirmButtonColor: 'var(--button-bg)' // Use action button color
                 }).then(() => {
                    form.reset();
                    form.style.display = 'none'; // Hide form after success
                    document.querySelector('.step-indicator-container').style.display = 'none'; // Hide progress bar too
                    // You could show a simple "Thank You" message here if desired
                    const thankYouMsg = document.createElement('p');
                    thankYouMsg.textContent = 'ขอขอบคุณสำหรับข้อมูล';
                    thankYouMsg.style.textAlign = 'center';
                    thankYouMsg.style.fontSize = '1.2em';
                    thankYouMsg.style.marginTop = '20px';
                    form.parentNode.appendChild(thankYouMsg);

                    // Reset progress indicator visually if form were to reappear
                    // updateProgressIndicator(1);
                    // submitBtn.disabled = false; // Re-enable if form can be submitted again
                 });

            })
            .catch(error => {
                console.error('Error submitting form:', error);
                 Swal.close(); // Close loading indicator
                 // Show SweetAlert error popup
                 Swal.fire({
                    title: 'เกิดข้อผิดพลาด!',
                    text: 'ไม่สามารถส่งข้อมูลได้ โปรดตรวจสอบการเชื่อมต่ออินเทอร์เน็ต หรือลองอีกครั้ง',
                    icon: 'error',
                    confirmButtonText: 'ตกลง',
                    confirmButtonColor: 'var(--danger-color)'
                 });
                submitBtn.disabled = false; // Re-enable button on error
            });
        });

        // Initialize the first step and progress bar
        showStep(currentStep);
    </script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</body>
</html>